

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Read experimental matrix &mdash; micropyro 0.1.post21+g35e12a5 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Compute yields" href="compute-yields.html" />
    <link rel="prev" title="Read a Blob File" href="read-blob.html" />
    <link href="_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> micropyro
          

          
          </a>

          
            
            
              <div class="version">
                0.1.post21+g35e12a5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="loading-module.html">Loading Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="read-database.html">Read a Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="read-blob.html">Read a Blob File</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Read experimental matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="compute-yields.html">Compute yields</a></li>
<li class="toctree-l1"><a class="reference internal" href="external-calibration.html">External calibration</a></li>
<li class="toctree-l1"><a class="reference internal" href="post-processing.html">Post processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="generate-database.html">Generate Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities-docs.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="release-history.html">Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="min_versions.html">Requires</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">micropyro</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Read experimental matrix</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/experiment-reader.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="read-experimental-matrix">
<h1>Read experimental matrix<a class="headerlink" href="#read-experimental-matrix" title="Permalink to this headline">¶</a></h1>
<p>Typically, one performs several experiments and keeps track of them in a more or less simple excel sheet.
Usually, one records the mass of the different components, including sample and internal standard, etc.
The filename is also recorded and used as index in the following as it is a good (unique) identifier.
A class <code class="code docutils literal notranslate"><span class="pre">ReadExperimentTable</span></code> is used to read the experimental matrix.
As with the database, several types of files may be used for this, but for the moment, let us focus on xls files.
Then, the experimental matrix can be read:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">micropyro</span> <span class="k">as</span> <span class="nn">mp</span>

<span class="n">exp_matrix</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">ReadExperimentTable</span><span class="o">.</span><span class="n">from_xls</span><span class="p">(</span><span class="s2">&quot;Micropyrolysis.xlsx&quot;</span><span class="p">,</span>
                                      <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Micropyro&quot;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                      <span class="n">usecols</span><span class="o">=</span><span class="s2">&quot;A:V&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, we skip the first row (skiprows=1), we set the first read column as the header, and then use only columns from A to V.</p>
<p>Often, we use internal standard mixture, but we are interested only in the part that gets pyrolyzed, thus its contribution can be obtained using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">exp_matrix</span><span class="o">.</span><span class="n">compute_is_amount</span><span class="p">(</span><span class="n">concentration</span><span class="o">=</span><span class="mf">0.0335</span><span class="p">)</span>
</pre></div>
</div>
<p>We can also compute the char content, given the mass before and after:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">exp_matrix</span><span class="o">.</span><span class="n">compute_char</span><span class="p">()</span>
</pre></div>
</div>
<p>A specific row can be extracted using pandas syntax:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">experiment_df_row</span> <span class="o">=</span> <span class="n">exp_matrix</span><span class="o">.</span><span class="n">experiment_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;100 ug material py_600c&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>But we can access any quantity, anytime. To plot the char yield, we simply:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># required for plotting</span>

<span class="n">char_yield</span> <span class="o">=</span> <span class="n">exp_matrix</span><span class="o">.</span><span class="n">experiment_df</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">% c</span><span class="s2">har&quot;</span><span class="p">]</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="n">exp_matrix</span><span class="o">.</span><span class="n">experiment_df</span><span class="o">.</span><span class="n">temperature</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span> <span class="n">char_yield</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;char_yield.pdf&quot;</span><span class="p">)</span>  <span class="c1"># save it to a file</span>
</pre></div>
</div>
<p>The description of the class is as follows:</p>
<dl class="py class">
<dt id="micropyro.ReadExperimentTable">
<em class="property">class </em><code class="sig-prename descclassname">micropyro.</code><code class="sig-name descname">ReadExperimentTable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">experiment_df</span></em>, <em class="sig-param"><span class="n">used_is</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/micropyro/experimental_matrix.html#ReadExperimentTable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#micropyro.ReadExperimentTable" title="Permalink to this definition">¶</a></dt>
<dd><p>A class used to read experimental matrix typically done in micropyrolysis
The idea is to have different constructors to create the df (csv, json, xls, etc).
Each constructor should return the appropriate pandas dataframe as described in the test cases.
All mass should be given in <strong>mg</strong>.
…</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>experiment_df</strong><span class="classifier">df</span></dt><dd><p>a pandas dataframe with the information on the various experiments performed.</p>
</dd>
<dt><strong>used_is</strong><span class="classifier">bool</span></dt><dd><p>define if internal standard was used (True) or not (False)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 56%" />
<col style="width: 44%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>from_xls(cls, filename, sheet_name=0, use_is=True, **kwargs)</strong></p></td>
<td><p>Class method to load a xls file</p></td>
</tr>
<tr class="row-even"><td><p><strong>from_json(cls)</strong></p></td>
<td><p>Class method to load a json file (not available yet)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>from_dict(cls, filename, sheet_name=0, use_is=True, **kwargs)</strong></p></td>
<td><p>Class method to load a dict</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="compute-yields.html" class="btn btn-neutral float-right" title="Compute yields" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="read-blob.html" class="btn btn-neutral float-left" title="Read a Blob File" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Francisco Torres

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>